## Strapi 常见表单字段类型与用法

### 文本类
- **string（短文本）**
  - 用途: 标题、名称、邮箱等
  - 关键配置: `required`, `unique`, `minLength`, `maxLength`, `regex`
  - 示例:
    ```json
    "title": { "type": "string", "required": true, "maxLength": 120 }
    ```

- **text（长文本）**
  - 用途: 摘要、描述
  - 关键配置: `required`, `maxLength`
  - 示例:
    ```json
    "description": { "type": "text", "maxLength": 500 }
    ```

- **richtext（富文本）**
  - 用途: 正文内容（加粗、列表、链接等）
  - 示例（组件内使用，见本项目 `shared.rich-text`）:
    ```json
    "body": { "type": "richtext" }
    ```

### 标识类
- **uid（唯一标识）**
  - 用途: URL 友好唯一标识（如 `slug`）
  - 关键配置: `targetField`
  - 示例（本项目 `article.slug`）:
    ```json
    "slug": { "type": "uid", "targetField": "title" }
    ```

### 关系与结构
- **relation（关系）**
  - 用途: 模型关联（`oneToOne`, `oneToMany`, `manyToOne`, `manyToMany`）
  - 关键配置: `relation`, `target`, `inversedBy`/`mappedBy`
  - 示例（文章 → 作者，多对一）:
    ```json
    "author": {
      "type": "relation",
      "relation": "manyToOne",
      "target": "api::author.author",
      "inversedBy": "articles"
    }
    ```

- **component（组件）**
  - 用途: 可复用字段集合
  - 关键配置: `component`, `repeatable`
  - 示例（本项目 `global.defaultSeo`）:
    ```json
    "defaultSeo": { "type": "component", "repeatable": false, "component": "shared.seo" }
    ```

- **dynamiczone（动态区）**
  - 用途: 由多个组件拼装的灵活内容区
  - 关键配置: `components`
  - 示例（本项目 `article.blocks`）:
    ```json
    "blocks": {
      "type": "dynamiczone",
      "components": ["shared.media", "shared.quote", "shared.rich-text", "shared.slider"]
    }
    ```

### 媒体与文件
- **media（媒体）**
  - 用途: 图片/视频/文件上传与选择
  - 关键配置: `multiple`, `required`, `allowedTypes`
  - 示例（本项目 `article.cover`）:
    ```json
    "cover": {
      "type": "media",
      "multiple": false,
      "allowedTypes": ["images", "files", "videos"]
    }
    ```

### 布尔与数字
- **boolean（布尔）**
  - 用途: 开关、是否展示
  - 关键配置: `default`
  - 示例:
    ```json
    "isFeatured": { "type": "boolean", "default": false }
    ```

- **number（数字）**：`integer`/`biginteger`/`float`/`decimal`
  - 用途: 计数、排序、金额
  - 关键配置: `min`, `max`, `default`
  - 示例:
    ```json
    "order": { "type": "integer", "default": 0, "min": 0 }
    ```

### 日期与时间
- **date/datetime/time**
  - 用途: 发布日期、活动时间
  - 示例:
    ```json
    "publishedOn": { "type": "datetime" }
    ```

### 其他常用
- **email（邮箱）**
  - 自动邮箱格式校验
  - 示例:
    ```json
    "email": { "type": "email", "required": true }
    ```

- **password（密码）**
  - 后台安全输入；API 不回传明文
  - 示例:
    ```json
    "password": { "type": "password", "minLength": 8 }
    ```

- **enumeration（枚举）**
  - 固定集合单选
  - 示例:
    ```json
    "status": { "type": "enumeration", "enum": ["draft", "published", "archived"], "default": "draft" }
    ```

- **json（原始 JSON）**
  - 任意结构数据
  - 示例:
    ```json
    "metadata": { "type": "json" }
    ```

### 通用能力与验证
- 常用校验与控制：`required`, `unique`, `minLength`, `maxLength`, `min`, `max`, `regex`, `default`
- 草稿发布：在内容类型级别配置 `options.draftAndPublish: true`
- API 查询：关系/媒体建议通过 `populate` 获取关联数据

### 命名规范与约束（重要）
- 内容类型元信息位于 `schema.json.info`：
  - `singularName`: 必须为小写、可含连字符（kebab-case），如 `category`
  - `pluralName`: 必须为小写、可含连字符（kebab-case），如 `categories`、`blog-categories`
  - `displayName`: 面板显示名，自由文本（可含空格与大写）
- 常见报错：`invalid_string / Must be kebab case (path: info.pluralName 或 data.contentTypes.*.pluralName)`
  - 修复：将 `pluralName` 改为全小写并使用连字符分隔，例如 `test-single-types`、`blog-categories`

### 进阶校验示例
- 字符串强制 kebab-case：
  ```json
  "machineName": { "type": "string", "regex": "^[a-z]+(-[a-z]+)*$" }
  ```
- 长度与范围：
  ```json
  "summary": { "type": "text", "minLength": 10, "maxLength": 500 },
  "order": { "type": "integer", "min": 0, "max": 9999 }
  ```
- 唯一约束：
  ```json
  "code": { "type": "string", "unique": true }
  ```

### API 查询与 populate 示例
- 关系与媒体一次性展开：
  - REST：`GET /api/articles?populate=author,cover,category`
  - 深层与动态区：
    - `GET /api/articles?populate[author]=*&populate[cover]=*&populate[blocks]=*&populate[category]=*`
- GraphQL（若启用）：
  ```graphql
  query {
    articles { data { id attributes { title cover { data { attributes { url } } } author { data { attributes { name } } } } } }
  }
  ```

### 常见错误与快速修复
- 创建内容类型时报 `Must be kebab case`：
  - 原因：`pluralName` 或 `singularName` 未按 kebab-case 命名
  - 处理：改为全小写，用 `-` 连接（如 `test-single-type` / `test-single-types`）
- 媒体字段为空导致上传失败：
  - 处理：检查 `allowedTypes` 是否包含需要的类型；单图用 `multiple: false`
- `uid` 重复：
  - 处理：确认目标字段是否唯一；或在创建时手动设置唯一 `uid`

### 可复用 attributes 片段（可直接粘贴到 schema.json）
以下为“栏目/分类”常见字段集合示例：
```json
{
  "name": { "type": "string", "required": true, "maxLength": 60 },
  "slug": { "type": "uid", "targetField": "name" },
  "description": { "type": "text", "maxLength": 500 },
  "order": { "type": "integer", "default": 0, "min": 0 },
  "isActive": { "type": "boolean", "default": true },
  "publishedOn": { "type": "datetime" },
  "cover": { "type": "media", "multiple": false, "allowedTypes": ["images"] },
  "seo": { "type": "component", "repeatable": false, "component": "shared.seo" },
  "parent": { "type": "relation", "relation": "manyToOne", "target": "api::category.category", "inversedBy": "children" },
  "children": { "type": "relation", "relation": "oneToMany", "target": "api::category.category", "mappedBy": "parent" },
  "blocks": { "type": "dynamiczone", "components": ["shared.media", "shared.rich-text", "shared.quote", "shared.slider"] }
}
```
- 对应的类型头部元信息建议：
```json
{
  "kind": "collectionType",
  "info": {
    "singularName": "category",
    "pluralName": "categories",
    "displayName": "Category"
  },
  "options": { "draftAndPublish": false }
}
```


